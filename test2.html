<!DOCTYPE html>
<html>

<head>
    <title>Leaflet Time Slider Example</title>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css" type="text/css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.6.0/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <!-- Include this library for mobile touch support  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>

    <!-- Include SliderControl.js script -->
    <script src="src/SliderControl.js"></script>
	
    <!-- Style map -->
    <style>
	#myMap {
	    width: 80%; 
	    height: 600px;
	    postion: relative;
	    margins: auto;
	}
	</style>
</head>

<body>
    
    <!-- Add div to contain #myMap -->
    <div id="myMap"></div>



    <script>
	var sliderControl = null;

	// Create geoJSON dataset (if linking mulitple markers together to appear/hide at once, all those linked go into one dataset)
	var dataset1 = [	
	    {
		type: 'Feature',
		geometry: {
		    type: 'Point',
		    coordinates: [-73.8, 40.7]
		},
		properties: {
		    title: 'Popup 1',
		    description: 'Hello World!',
		    time: '1992/01'
		}
	    },
	    {
		type: 'Feature',
		geometry: {
		    type: 'Point',
		    coordinates: [-73.9, 40.6]
		},
		properties: {
		    title: 'Popup 2',
		    description: 'Hello again, World!',
		    time: '1992/06'
		}
	    }
	]
	/*
	// Create second dataset of linked markers
	var points1993 = [
	    {
		type: 'Feature',
		geometry: {
		    type: 'Point',
		    coordinates: [-74.0, 40.8]
		},
		properties: {
		    title: 'Popup 3',
		    description: 'Hello World, once more!',
		    time: '1993/05'
		}
	    },
	    {
		type: 'Feature',
		geometry: {
		    type: 'Point',
		    coordinates: [-73.9, 40.8]
		},
		properties: {
		    title: 'Popup 4',
		    description: 'Last time: Hello World!',
		    time: '1993/08'
		}
	    }			
	]
	*/
	// Create map inside div with #myMap ID; set view 
	var map1 = L.map('myMap').setView([40.7,-73.9], 11);
	 
	// Add tileLayer to map
	var basemap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    	    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	}).addTo(map1);

	//Create an empty layerGroup and add it to the map
	var group1 = L.layerGroup().addTo(map1);
	/*
	// If creating groups of linked markers, create an empty layerGroup for each set
	var group2 = L.layerGroup().addTo(map);
	*/
	
	// Specify function that will load markers, set icons, bind popups with geoJSON content into the specified layer
	function addToGroup1 (feature, layer) {
  	    group1.addLayer(layer);
  	    var content = "<div style='clear: both'></div><div><strong>" + feature.properties.date + "</strong><br>" + feature.properties.description + "</div>";
	    /*layer.setIcon( // use this if defining custom icons in geoJSON
		feature.properties.icon
		// or define icon settings here
		); */
	    Object.defineProperty(layer, 'date', {feature.properties.date});
	    layer.bindPopup(content, {closeButton: true});
	};
	/* 
	// If creating multiple groups to be controlled, repeat code for other groups, until all are covered
	function addToGroup2 (feature, layer) {
  	    group2.addLayer(layer);
  	    var content = "<div style='clear: both'></div><div><strong>" + feature.properties.date + "</strong><br>" + feature.properties.description + "</div>";
	    /*layer.setIcon(
		feature.properties.icon // use this if defining custom icons in geoJSON
		// or define icon settings here
		); *//*
	    layer.bindPopup(content, {closeButton: true});
	};
	*/
	// Create an options object that uses the functions above for each marker in the group
	var optionsObject1 = {
  	    // If creating groups to be controlled simultaneously, specify an overarching time for all of the items in this group
	    //time: '1992',
	    onEachFeature: addToGroup1
	};
	/*
	// If creating multiple groups, repeat above for each group
	var optionsObject2 = {
  	    // Specify an overarching time for all of the items in this group
	    //time: '1993',
	    onEachFeature: addToGroup2
	}
	*/
	// For single group, load dataset, popups, etc. into a geoJSON layer, then create a final layerGroup from it
	var fullGroup1 = L.geoJSON(dataset1, addToGroup1);
	var finalSingleGroup = L.layerGroup(fullGroup1);
	/*
	// For multiple groups, remove function above and instead create new variables for each group, using their dataset and function 
	var fullGroup1 = L.geoJSON(dataset1, addToGroup1);
	var fullGroup2 = L.geoJSON(dataset2, addToGroup2);
	// For multiple groups, create final layerGroup to hold all of these geoJSON variables in an array
	var multipleLayerGroups = L.layerGroup([ fullgroup1, fullGroup2 ]);
	*/
	// Create Slider
	var sliderControl = L.control.sliderControl( {
	    // Set layer below to EITHER the first layerGroup, from the be beginning, OR the final layerGroup containing the array
	    layer: finalSingleGroup,
	    alwaysShowDate: true,
	    showAllOnStart: true
	});
	// Add the slider to the map
	map1.addControl(sliderControl);
	// Initialize the slider
	sliderControl.startSlider();

    </script>
</body>

</html>
